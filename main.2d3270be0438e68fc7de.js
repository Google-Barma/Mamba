(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"Dv/5":function(e,t,n){},I8aK:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfkCh0KDjAcD/wjAAAAAW9yTlQBz6J3mgAAAKpJREFUGNNj+I8GGIgS+JarrRsx8RtCoJVPw0vGN/x2xfJ/EIFototvzK4/t3xw+ClEYCJD+efdl3/YzX8BVfHDi5HTuWrfYcEtEDP+ffuzNkSMnUN/Ds+Cf0CBYwoMfMHrPl4KZihdzLwfKODN4JcuySumJcna+k8uACiQweDanSPKwMAgtWYfhz9Q4I0nkCOW3J7GzcDAtANs6PWl238AzX/enrGHGM8BABaxt9LDbfuEAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTEwLTI5VDEwOjE0OjQ3KzAwOjAwdDttFQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0xMC0yOVQxMDoxNDo0NyswMDowMAVm1akAAAAASUVORK5CYII="},K51s:function(e,t,n){},KJOC:function(e,t,n){},OPH6:function(e,t,n){},QfWi:function(e,t,n){"use strict";n.r(t);n("OPH6"),n("Dv/5"),n("K51s");var r={email:document.querySelector("#inputEmail"),userName:document.querySelector("#inputUserName"),password:document.querySelector("#inputPassword"),login:document.querySelector("#loginbtn"),singup:document.querySelector("#singupbtn"),logout:document.querySelector("#logoutbtn"),startButton:document.querySelector(".snake-start"),canvas:document.querySelector("#canvas"),modeWrp:document.querySelector(".mode-wrp"),snakeScore:document.querySelector(".snake-score"),topList:document.querySelector(".players-list"),userStatsRef:document.querySelector(".individual-stats"),userStats:document.querySelector(".individual-stats-wrapper"),game:document.querySelector(".snake-wrp"),gameWrap:document.querySelector(".main-content-wrap"),regTitle:document.querySelector(".registration__title"),regUser:document.querySelector(".registration__user"),registration:document.querySelector(".registration"),logoutWrap:document.querySelector(".logout-wrap"),mainSignInBtn:document.querySelector('.btn[data-type="signin"]'),mainSignUpBtn:document.querySelector('.btn[data-type="signup"]'),authModal:document.getElementById("auth-modal"),authModalOverlay:document.getElementById("auth-modal-overlay"),openModal:document.querySelector(".sing-in-wrap"),closeModalBtn:document.getElementById("close-auth-modal")};n("iPZ8"),n("kypl"),n("pCzD"),n("hi3g"),n("4owi"),n("IvQZ"),n("/YXa"),n("WB5j"),n("aOEW"),n("D/wG"),n("1Qwx"),n("JBxO"),n("JjHl"),n("FdtR"),n("9UJh"),n("4NM0"),n("WoWj"),n("SgDD"),n("U00V"),n("wcNg"),n("8cZI"),n("lmye");function a(){return"ignoreWallsCollisionMode"===localStorage.getItem("mode")?"arcade":"classic"}function o(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function s(e){o(i,r,a,s,c,"next",e)}function c(e){o(i,r,a,s,c,"throw",e)}s(void 0)}))}}function s(){return c.apply(this,arguments)}function c(){return(c=i(regeneratorRuntime.mark((function e(){var t,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a(),e.next=3,N(t);case 3:n=e.sent,o=n.map((function(e,t){return 0===t?'<li class="player bg-place"><span class="players-number pn-one">'+(t+1)+"</span>"+e.name+" - "+e.score+" points</li>":1===t?'<li class="player bg-place"><span class="players-number pn-two">'+(t+1)+"</span>"+e.name+" - "+e.score+" points</li>":2===t?'<li class="player bg-place"><span class="players-number pn-three">'+(t+1)+"</span>"+e.name+" - "+e.score+" points</li>":'<li class="player"><span class="players-number">'+(t+1)+"</span>"+e.name+" - "+e.score+" points </li>"})),r.topList.innerHTML=o.join(" ");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(){return l.apply(this,arguments)}function l(){return(l=i(regeneratorRuntime.mark((function e(){var t,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a(),e.next=3,D();case 3:n=e.sent,r.userStats.innerHTML="",o='<p class="top-description">Total games: <span class="individual-stats-result">'+n.total+'</span></p>\n  <p class="top-description">Mode games: <span class="individual-stats-result">'+n[t].total+'</span></p>\n  <p class="top-description">Max score: <span class="individual-stats-result">'+n[t].maxScore+"</span></p>",r.userStats.insertAdjacentHTML("beforeend",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){r.authModal.classList.remove("is-open"),window.removeEventListener("keydown",p)}function p(e){"Escape"===e.key&&d()}function m(e){e.classList.add("is-hidden")}function f(e){e.classList.contains("is-hidden")&&e.classList.remove("is-hidden")}r.openModal.addEventListener("click",(function(e){"logout"!==e.target.dataset.type&&"BUTTON"===e.target.nodeName&&(r.authModal.classList.add("is-open"),window.addEventListener("keydown",p)),"signin"===e.target.dataset.type&&(r.userName.style.display="none",r.email.style.display="block",r.password.style.display="block",r.login.style.display="block",r.singup.style.display="none"),"signup"===e.target.dataset.type&&(r.userName.style.display="block",r.email.style.display="block",r.password.style.display="block",r.login.style.display="none",r.singup.style.display="inline-block")})),r.closeModalBtn.addEventListener("click",(function(e){d()})),r.authModalOverlay.addEventListener("click",(function(e){e.target===e.currentTarget&&d()}));var h=n("KDl+"),g=n.n(h);n("VwVG"),n("SHTW");function v(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function A(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){w(o,r,a,i,s,"next",e)}function s(e){w(o,r,a,i,s,"throw",e)}i(void 0)}))}}function b(){return(b=A(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,n=g.a.auth(),e.next=5,n.signInWithEmailAndPassword(r.email.value,r.password.value);case 5:return d(),m(r.registration),r.regUser.style.display="block",e.next=10,D();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),alert("Failed to login");case 15:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function S(){return(S=A(regeneratorRuntime.mark((function e(t){var n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,(n=r.userName.value).trim()){e.next=6;break}return alert("Wrong user name"),e.abrupt("return");case 6:return e.next=8,T(n);case 8:if(!e.sent){e.next=21;break}return a=g.a.auth(),e.next=13,a.createUserWithEmailAndPassword(r.email.value,r.password.value);case 13:return o=e.sent,e.next=16,x(o,n);case 16:m(r.registration),r.regUser.style.display="block",d(),e.next=22;break;case 21:alert("Username already exists");case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(1),alert("User with this e-mail already exists");case 27:case"end":return e.stop()}}),e,null,[[1,24]])})))).apply(this,arguments)}function x(e,t){return k.apply(this,arguments)}function k(){return(k=A(regeneratorRuntime.mark((function e(t,n){var r,a,o,i,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.user;try{a=r.uid,o=r.email,i=g.a.database(),s=i.ref("users"),c=i.ref("stats"),i.ref("userNames").push(n),s.child(a).set({email:o,userName:n}),c.child(a+"/classic").set({total:0,maxScore:0}),c.child(a+"/arcade").set({total:0,maxScore:0}),c.child(a+"/total").set(0)}catch(e){console.error("user add failed")}case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(){return!!g.a.auth().currentUser}function M(){return g.a.auth().currentUser.uid}function E(){return L.apply(this,arguments)}function L(){return(L=A(regeneratorRuntime.mark((function e(){var t,n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=M(),n=g.a.database(),r=n.ref("/users/"+t+"/userName"),e.next=5,r.once("value");case 5:return a=e.sent,e.abrupt("return",a.val());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){return C.apply(this,arguments)}function C(){return(C=A(regeneratorRuntime.mark((function e(t){var n,r,a,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=g.a.database(),r=n.ref("userNames"),e.next=5,r.once("value");case 5:return a=e.sent,o=a.val(),i=Object.values(o),e.abrupt("return",!i.includes(t));case 11:e.prev=11,e.t0=e.catch(0),console.error("Cannot read data from DB!");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function D(){return I.apply(this,arguments)}function I(){return(I=A(regeneratorRuntime.mark((function e(){var t,n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=M(),n=g.a.database(),r=n.ref("/stats/"+t),e.next=5,r.once("value");case 5:return a=e.sent,e.abrupt("return",a.val());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return(q=A(regeneratorRuntime.mark((function e(t){var n,r,o,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=M(),e.next=3,D();case 3:return r=e.sent,o=a(),r.total+=1,"classic"===o&&r.classic.maxScore<t&&(r.classic.maxScore=t,r.classic.total+=1),"arcade"===o&&r.arcade.maxScore<t&&(r.arcade.maxScore=t,r.arcade.total+=1),i=g.a.database(),s=i.ref("/stats/"+n),e.next=12,s.set(r);case 12:u();case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,t){return W.apply(this,arguments)}function W(){return(W=A(regeneratorRuntime.mark((function e(t,n){var r,a,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=g.a.database(),a=r.ref("/TOP10/"+n),o=K(t),i=U(o),a.set(i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){return O.apply(this,arguments)}function O(){return(O=A(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g.a.database(),r=n.ref("/TOP10/"+t),e.next=4,r.once("value");case 4:return a=e.sent,e.abrupt("return",a.val());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=A(regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a(),e.next=3,N(n);case 3:if(r=e.sent,o=r[r.length-1],!(r.length<10||t>o.score)){e.next=14;break}return e.next=8,E();case 8:return i=e.sent,r.length<10?r[r.length]={name:i,score:t}:r[r.length-1]={name:i,score:t},e.next=12,B(r,n);case 12:return s(),e.abrupt("return",!0);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){for(var t,n=[],r=new Map,a=v(e);!(t=a()).done;){var o=t.value;r.has(o.name)||(r.set(o.name,!0),n.push({name:o.name,score:o.score}))}return n}function K(e){return[].concat(e).sort((function(e,t){return t.score-e.score}))}r.login.addEventListener("click",(function(e){return b.apply(this,arguments)})),r.logout.addEventListener("click",(function(e){e.preventDefault(),g.a.auth().signOut(),r.regUser.style.display="none",f(r.registration),r.regTitle.innerHTML="Login / Registration"})),r.singup.addEventListener("click",(function(e){return S.apply(this,arguments)})),g.a.initializeApp({apiKey:"AIzaSyBMhO0NQUdNhSwM2MzfffK0CnXNvO-SQ5Q",authDomain:"snake-e2214.firebaseapp.com",databaseURL:"https://snake-e2214.firebaseio.com",projectId:"snake-e2214",storageBucket:"snake-e2214.appspot.com",messagingSenderId:"1059522027824",appId:"1:1059522027824:web:73740d4b7a4ff4094228f5"}),g.a.auth().onAuthStateChanged((function(e){e?(r.regTitle.innerHTML="You are logged in as:",E().then((function(e){return r.regUser.textContent=e})),m(r.registration),f(r.logoutWrap),u(),r.userStatsRef.style.display="block"):(m(r.logoutWrap),r.regUser.style.display="none",r.userStatsRef.style.display="none")})),s();n("RtS0"),n("3dw1"),n("C4nn");var J=function(e,t,n,r){ie.beginPath(),ie.arc(e,t,n,0,2*Math.PI,!1),r&&ie.fill()},j=r.canvas,Q=function(){var e=document.body.clientWidth;return e<1251&&e>576?480:e<576&&e>362?360:e<362?324:528};j.width=Q(),j.height=Q();var G=j.width,H=j.height,z=G/12,V=H/12,Y=function(){function e(e,t){this.col=e,this.row=t}var t=e.prototype;return t.drawSquare=function(e){var t=12*this.col,n=12*this.row;ie.fillStyle=e,ie.fillRect(t,n,12,12)},t.drawCircle=function(e){var t=12*this.col+6,n=12*this.row+6;ie.fillStyle=e,J(t,n,6,!0)},t.equal=function(e){return this.col===e.col&&this.row===e.row},e}(),F=new(function(){function e(){this.position=new Y(10,10)}var t=e.prototype;return t.draw=function(){this.position.drawCircle("yellow")},t.move=function(){var e=Math.floor(Math.random()*(z-2))+1,t=Math.floor(Math.random()*(V-2))+1;this.position=new Y(e,t)},e}());function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=function(){function e(e){void 0===e&&(e="classic"),this.segments=[new Y(7,5),new Y(6,5),new Y(5,5)],this.direction="right",this.nextDirection="right",this.mode=e,this.score=0,this.animationTime=100}var t,n,r,a=e.prototype;return a.draw=function(){for(var e=!1,t=0;t<this.segments.length;t+=1)e?this.segments[t].drawSquare("#33d9de "):this.segments[t].drawSquare("#6ab1d7 "),e=!e;this.segments[0].drawSquare("#fff")},a.move=function(){var e,t=this.segments[0];this.direction=this.nextDirection,"right"===this.direction?e=new Y(t.col+1,t.row):"down"===this.direction?e=new Y(t.col,t.row+1):"left"===this.direction?e=new Y(t.col-1,t.row):"up"===this.direction&&(e=new Y(t.col,t.row-1)),this.checkCollision(e)?he():(this.segments.unshift(e),e.equal(F.position)?(this.score+=1,this.animationTime>=3?"classic"===this.mode?this.score>20?this.animationTime-=1:this.animationTime-=2:"ignoreWallsCollisionMode"===this.mode&&(this.score<10?this.animationTime-=3:this.score>10&&this.score<28?this.animationTime-=2:this.score>28&&this.score<40?this.animationTime-=1:this.score>40?this.animationTime-=.5:this.score>50&&(this.animationTime=this.animationTime)):1!==this.animationTime&&0!==this.animationTime||(this.animationTime=1),F.move()):this.segments.pop())},a.ignoreWallsCollisionMode=function(e,t,n,r,a,o,i){return a&&n?i.col=1:a&&e?i.col=z-1:a&&t?i.row=V-1:a&&r&&(i.row=1),o},a.classicMode=function(e,t){return e||t},a.checkCollision=function(e){var t=0===e.col,n=0===e.row,r=e.col===z-1,a=e.row===V-1,o=t||n||r||a,i=!1;if(this.segments.forEach((function(t){e.equal(t)&&(i=!0)})),null!==this.mode&&this.mode){if("classic"===this.mode)return this.classicMode(o,i);if("ignoreWallsCollisionMode"===this.mode)return this.ignoreWallsCollisionMode(t,n,r,a,o,i,e)}},a.setDirection=function(e){"up"===this.direction&&"down"===e||"right"===this.direction&&"left"===e||"down"===this.direction&&"up"===e||"left"===this.direction&&"right"===e||(this.nextDirection=e)},t=e,(n=[{key:"getScore",get:function(){return this.score}},{key:"setScore",set:function(e){return this.score=e}},{key:"getAnimationTime",get:function(){return this.animationTime}},{key:"setAnimationTime",set:function(e){this.animationTime=e}}])&&Z(t.prototype,n),r&&Z(t,r),e}(),_={ArrowLeft:"left",ArrowUp:"up",ArrowRight:"right",ArrowDown:"down",KeyA:"left",KeyW:"up",KeyD:"right",KeyS:"down"},$=null,ee=null,te=function(e){e.preventDefault(),e.stopPropagation(),$={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY},ee={x:$.x,y:$.y}},ne=function(e){e.preventDefault(),e.stopPropagation(),ee={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}},re=function(e){e.preventDefault(),e.stopPropagation(),ae(),$=null,ee=null},ae=function(){var e={x:$.x-ee.x,y:$.y-ee.y},t="";Math.abs(e.x)>Math.abs(e.y)?Math.abs(e.x)>20&&(t=e.x>0?"left":"right"):Math.abs(e.y)>20&&(t=e.y>0?"up":"down"),fe(t),console.log(t)},oe=(n("KJOC"),r.modeWrp.querySelectorAll("input")),ie=r.canvas.getContext("2d"),se=!1,ce=null,ue=0,le=function(e){switch(e.code){case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":case"Space":e.preventDefault()}},de=function(e){var t=_[e.code];void 0!==t&&ce.setDirection(t)},pe=ie.createLinearGradient(0,0,170,0);pe.addColorStop(0,"#6ab1d7 "),pe.addColorStop(.5,"#38d9de  "),pe.addColorStop(1,"#33d9de ");var me=function(){ie.fillStyle=pe,ie.fillRect(0,0,G,12),ie.fillRect(0,H-12,G,12),ie.fillRect(0,0,12,H),ie.fillRect(G-12,0,12,H)},fe=function(e){se&&("up"!==e&&"down"!==e&&"right"!==e&&"left"!==e||void 0!==e&&ce.setDirection(e))},he=function(){se=!1,function(e){q.apply(this,arguments)}(ue),function(e){return P.apply(this,arguments)}(ue)||s(),ce.setScore=0,se||(r.startButton.removeAttribute("disabled","disabled"),document.removeEventListener("keydown",de),oe.forEach((function(e){e.removeAttribute("disabled","disabled")})),window.removeEventListener("keydown",le,!1),canvas.removeEventListener("touchstart",(function(e){return te(e)})),canvas.removeEventListener("touchmove",(function(e){return ne(e)})),canvas.removeEventListener("touchend",re),canvas.removeEventListener("touchcancel",re)),ie.font="500 52px Arial",ie.fillStyle="#fff",ie.textAlign="center",ie.textBaseline="middle",ie.fillText("Game Over",G/2,H/2)};if(null===localStorage.getItem("mode")&&localStorage.setItem("mode","classic"),null!==localStorage.getItem("mode")){var ge=localStorage.getItem("mode");oe.forEach((function(e){ge===e.dataset.mode&&e.setAttribute("checked","checked")}))}var ve=function(){ce=new X(localStorage.getItem("mode")),se=!0},ye=function e(){var t;null!==ce&&(t=ce.getAnimationTime,ue=ce.getScore,ie.clearRect(0,0,G,H),r.snakeScore.textContent="Score: "+ue,ce.move(),ce.draw(),F.draw(),me()),se&&(setTimeout(e,t),r.startButton.setAttribute("disabled","disabled"),oe.forEach((function(e){e.setAttribute("disabled","disabled")})),window.addEventListener("keydown",le,!1),document.addEventListener("keydown",de),canvas.addEventListener("touchstart",(function(e){return te(e)})),canvas.addEventListener("touchmove",(function(e){return ne(e)})),canvas.addEventListener("touchend",re),canvas.addEventListener("touchcancel",re))};me(),r.startButton.addEventListener("click",(function(){R()?(ve(),ye()):alert("You need to sign in first")})),r.modeWrp.addEventListener("click",(function(e){var t=e.target.dataset.mode;t&&(localStorage.setItem("mode",t),s(),R()&&u())})),new Promise((function(e,t){setTimeout(e,1e3)})).then((function(){var e=document.querySelector(".homepage"),t=document.getElementById("preloader");t.classList.add("hidden"),t.classList.remove("visible"),e.classList.remove("hidden")}));n("I8aK")}},[["QfWi",1,2]]]);
//# sourceMappingURL=main.2d3270be0438e68fc7de.js.map