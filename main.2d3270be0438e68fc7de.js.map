{"version":3,"sources":["webpack:///./favicon.png","webpack:///./js/refs.js","webpack:///./js/snake/modes.js","webpack:///./js/stats.js","webpack:///./js/auth-modal.js","webpack:///./js/show-hide.js","webpack:///./js/firebase.js","webpack:///./js/script.js","webpack:///./js/snake/circle.js","webpack:///./js/snake/blockSizes.js","webpack:///./js/snake/Block.js","webpack:///./js/snake/Apple.js","webpack:///./js/snake/SnakeClass.js","webpack:///./js/snake/directions.js","webpack:///./js/snake/touchFunctions.js","webpack:///./js/snake/snake.js","webpack:///./js/preloader.js"],"names":["module","exports","Refs","email","document","querySelector","userName","password","login","singup","logout","startButton","canvas","modeWrp","snakeScore","topList","userStatsRef","userStats","game","gameWrap","regTitle","regUser","registration","logoutWrap","mainSignInBtn","mainSignUpBtn","authModal","getElementById","authModalOverlay","openModal","closeModalBtn","getGameMode","localStorage","getItem","setStatsHTML","mode","getTopStats","data","statsHTML","map","e","i","name","score","refs","innerHTML","join","setPersonalStatsHTML","getUserStats","markup","total","maxScore","insertAdjacentHTML","onCloseModal","classList","remove","window","removeEventListener","onPressEsc","event","key","hideElement","elem","add","showElement","contains","addEventListener","target","dataset","type","nodeName","style","display","currentTarget","preventDefault","auth","firebase","signInWithEmailAndPassword","value","alert","trim","userNameAvailable","createUserWithEmailAndPassword","user","addUserToDB","uid","db","database","users","ref","stats","push","child","set","console","error","userLoggedIn","currentUser","getCurrentUserID","getUserName","userID","once","dataSnapshot","val","usedNames","Object","values","includes","newScore","classic","arcade","Stats","updateTopStats","newStats","sortedStats","getSortedTopList","uniqStats","getUniStatsList","topStats","minScore","length","list","Map","item","has","sort","firstEl","secondEl","signOut","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","onAuthStateChanged","fbUser","then","textContent","circle","x","y","radius","fillCircle","ctx","beginPath","arc","Math","PI","fill","getSize","size","body","clientWidth","width","height","widthInBlocks","heightInBlocks","Block","col","row","this","drawSquare","color","fillStyle","fillRect","drawCircle","centerX","blockSize","centerY","equal","otherBlock","apple","position","draw","move","randomCol","floor","random","randomRow","Snake","segments","direction","nextDirection","animationTime","isEvenSegment","newHead","head","checkCollision","gameOver","unshift","pop","ignoreWallsCollisionMode","leftCollision","topCollision","rightCollision","bottomCollision","wallCollision","selfCollision","classicMode","forEach","element","setDirection","newDirection","time","directions","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","KeyA","KeyW","KeyD","KeyS","touchStart","touchPosition","TouchStart","stopPropagation","changedTouches","clientX","clientY","TouchMove","TouchEnd","CheckAction","d","abs","swipeDirectionsMaker","log","modeInputs","querySelectorAll","getContext","playing","snake","arrowKeysHandler","code","directionsMaker","undefined","grd","createLinearGradient","addColorStop","drawBorder","updateUserStats","userGetTop","setScore","removeAttribute","font","textAlign","textBaseline","fillText","setItem","setAttribute","createNewSnake","gameLoop","getAnimationTime","getScore","clearRect","setTimeout","Promise","resolve","reject","preloader"],"mappings":"qGAAAA,EAAOC,QAAU,0lB,gJC+BFC,EA/BF,CACXC,MAAOC,SAASC,cAAc,eAC9BC,SAAUF,SAASC,cAAc,kBACjCE,SAAUH,SAASC,cAAc,kBACjCG,MAAOJ,SAASC,cAAc,aAC9BI,OAAQL,SAASC,cAAc,cAC/BK,OAAQN,SAASC,cAAc,cAC/BM,YAAaP,SAASC,cAAc,gBACpCO,OAAQR,SAASC,cAAc,WAC/BQ,QAAST,SAASC,cAAc,aAChCS,WAAYV,SAASC,cAAc,gBACnCU,QAASX,SAASC,cAAc,iBAChCW,aAAcZ,SAASC,cAAc,qBACrCY,UAAWb,SAASC,cAAc,6BAClCa,KAAMd,SAASC,cAAc,cAE7Bc,SAAUf,SAASC,cAAc,sBACjCe,SAAUhB,SAASC,cAAc,wBACjCgB,QAASjB,SAASC,cAAc,uBAChCiB,aAAclB,SAASC,cAAc,iBACrCkB,WAAYnB,SAASC,cAAc,gBAGnCmB,cAAepB,SAASC,cAAc,4BACtCoB,cAAerB,SAASC,cAAc,4BACtCqB,UAAWtB,SAASuB,eAAe,cACnCC,iBAAkBxB,SAASuB,eAAe,sBAC1CE,UAAWzB,SAASC,cAAc,iBAClCyB,cAAe1B,SAASuB,eAAe,qB,4NCzBlC,SAASI,IAEd,MAJyC,6BAG3BC,aAAaC,QAAQ,QAE1B,SANiB,U,4TCIrB,SAAeC,IAAtB,+B,iDAAO,8GACCC,EAAOJ,IADR,SAEcK,EAAYD,GAF1B,OAECE,EAFD,OAICC,EAAYD,EAAKE,KAAI,SAACC,EAAGC,GAC7B,OAAU,IAANA,EACF,oEACEA,EAAI,GADN,UAEUD,EAAEE,KAFZ,MAEsBF,EAAEG,MAFxB,eAGe,IAANF,EACT,oEACEA,EAAI,GADN,UAEUD,EAAEE,KAFZ,MAEsBF,EAAEG,MAFxB,eAGe,IAANF,EACT,sEACEA,EAAI,GADN,UAEUD,EAAEE,KAFZ,MAEsBF,EAAEG,MAFxB,eAIA,oDAA0DF,EAAI,GAA9D,UACED,EAAEE,KADJ,MAEMF,EAAEG,MAFR,mBAKJC,EAAK7B,QAAQ8B,UAAYP,EAAUQ,KAAK,KAvBnC,4C,sBA0BA,SAAeC,IAAtB,+B,iDAAO,8GACCZ,EAAOJ,IADR,SAEmBiB,IAFnB,OAEC/B,EAFD,OAGL2B,EAAK3B,UAAU4B,UAAY,GACrBI,EAJD,iFAI2FhC,EAAUiC,MAJrG,+FAK0EjC,EAAUkB,GAAMe,MAL1F,8FAMyEjC,EAAUkB,GAAMgB,SANzF,cAQLP,EAAK3B,UAAUmC,mBAAmB,YAAaH,GAR1C,4C,sBCtBA,SAASI,IACdT,EAAKlB,UAAU4B,UAAUC,OAAO,WAChCC,OAAOC,oBAAoB,UAAWC,GAGxC,SAASA,EAAWC,GACA,WAAdA,EAAMC,KACRP,ICfG,SAASQ,EAAYC,GAC1BA,EAAKR,UAAUS,IAAI,aAGd,SAASC,EAAYF,GACtBA,EAAKR,UAAUW,SAAS,cAC1BH,EAAKR,UAAUC,OAAO,aDmB1BX,EAAKf,UAAUqC,iBAAiB,SAAS,SAAAP,GAEP,WAA9BA,EAAMQ,OAAOC,QAAQC,MACK,WAA1BV,EAAMQ,OAAOG,WAzBf1B,EAAKlB,UAAU4B,UAAUS,IAAI,WAE7BP,OAAOU,iBAAiB,UAAWR,IA4BD,WAA9BC,EAAMQ,OAAOC,QAAQC,OACvBzB,EAAKtC,SAASiE,MAAMC,QAAU,OAC9B5B,EAAKzC,MAAMoE,MAAMC,QAAU,QAC3B5B,EAAKrC,SAASgE,MAAMC,QAAU,QAC9B5B,EAAKpC,MAAM+D,MAAMC,QAAU,QAC3B5B,EAAKnC,OAAO8D,MAAMC,QAAU,QAGI,WAA9Bb,EAAMQ,OAAOC,QAAQC,OACvBzB,EAAKtC,SAASiE,MAAMC,QAAU,QAC9B5B,EAAKzC,MAAMoE,MAAMC,QAAU,QAC3B5B,EAAKrC,SAASgE,MAAMC,QAAU,QAC9B5B,EAAKpC,MAAM+D,MAAMC,QAAU,OAC3B5B,EAAKnC,OAAO8D,MAAMC,QAAU,mBAIhC5B,EAAKd,cAAcoC,iBAAiB,SAAS,SAAAP,GAC3CN,OAGFT,EAAKhB,iBAAiBsC,iBAAiB,SAnCvC,SAAyBP,GACnBA,EAAMQ,SAAWR,EAAMc,eACzBpB,O,4tCEmBJ,WAA6Bb,GAA7B,6FACEA,EAAEkC,iBADJ,SAGUC,EAAOC,IAASD,OAH1B,SAIUA,EAAKE,2BACT3E,EAAKC,MAAM2E,MACX5E,EAAKK,SAASuE,OANpB,cASIzB,IACAQ,EAAY3D,EAAKoB,cACjBpB,EAAKmB,QAAQkD,MAAMC,QAAU,QAXjC,UAaUxB,IAbV,0DAeI+B,MAAM,mBAfV,2D,uEA4BA,WAAsBvC,GAAtB,6FACEA,EAAEkC,iBADJ,UAGUpE,EAAWJ,EAAKI,SAASwE,OACjBE,OAJlB,uBAKMD,MAAM,mBALZ,0CAQgCE,EAAkB3E,GARlD,0CAUYqE,EAAOC,IAASD,OAV5B,UAWyBA,EAAKO,+BACtBhF,EAAKC,MAAM2E,MACX5E,EAAKK,SAASuE,OAbtB,eAWYK,EAXZ,iBAgBYC,EAAYD,EAAM7E,GAhB9B,QAiBMuD,EAAY3D,EAAKoB,cACjBpB,EAAKmB,QAAQkD,MAAMC,QAAU,QAC7BnB,IAnBN,wBAqBM0B,MAAM,2BArBZ,0DAwBIA,MAAM,wCAxBV,2D,+BA4BeK,E,qFAAf,aAAqC9E,GAArC,gGAA6B6E,EAA7B,EAA6BA,KAC3B,IACUE,EAAeF,EAAfE,IAAKlF,EAAUgF,EAAVhF,MACPmF,EAAKV,IAASW,WACdC,EAAQF,EAAGG,IAAI,SACfC,EAAQJ,EAAGG,IAAI,SACHH,EAAGG,IAAI,aACfE,KAAKrF,GACfkF,EAAMI,MAAMP,GAAKQ,IAAI,CAAE1F,MAAOA,EAAOG,SAAUA,IAC/CoF,EAAME,MAASP,EAAf,YAA8BQ,IAAI,CAAE3C,MAAO,EAAGC,SAAU,IACxDuC,EAAME,MAASP,EAAf,WAA6BQ,IAAI,CAAE3C,MAAO,EAAGC,SAAU,IACvDuC,EAAME,MAASP,EAAf,UAA4BQ,IAAI,GAChC,SACAC,QAAQC,MAAM,mBAblB,4C,sBAiBO,SAASC,IACd,QAAOpB,IAASD,OAAOsB,YAGzB,SAASC,IACP,OAAOtB,IAASD,OAAOsB,YAAYZ,I,SAGtBc,I,gFAAf,gHACQC,EAASF,IACTZ,EAAKV,IAASW,WACdJ,EAAOG,EAAGG,IAAH,UAAiBW,EAAjB,aAHf,SAI6BjB,EAAKkB,KAAK,SAJvC,cAIQC,EAJR,yBAKSA,EAAaC,OALtB,4C,+BAQetB,E,mFAAf,WAAiC3E,GAAjC,8GAEUgF,EAAKV,IAASW,WACdC,EAAQF,EAAGG,IAAI,aAHzB,SAI+BD,EAAMa,KAAK,SAJ1C,cAIUC,EAJV,OAKUjE,EAAOiE,EAAaC,MACpBC,EAAYC,OAAOC,OAAOrE,GANpC,mBAOYmE,EAAUG,SAASrG,IAP/B,kCASIwF,QAAQC,MAAM,6BATlB,2D,sBAaO,SAAe/C,IAAtB,+B,iDAAO,gHACCoD,EAASF,IACTZ,EAAKV,IAASW,WACdtE,EAAYqE,EAAGG,IAAH,UAAiBW,GAH9B,SAIsBnF,EAAUoF,KAAK,SAJrC,cAICC,EAJD,yBAKEA,EAAaC,OALf,4C,uEAQA,WAA+BK,GAA/B,qGACCR,EAASF,IADV,SAEelD,IAFf,cAEC0C,EAFD,OAGCvD,EAAOJ,IACb2D,EAAMxC,OAAS,EAEF,YAATf,GACEuD,EAAMmB,QAAQ1D,SAAWyD,IAC3BlB,EAAMmB,QAAQ1D,SAAWyD,EACzBlB,EAAMmB,QAAQ3D,OAAS,GAGd,WAATf,GACEuD,EAAMoB,OAAO3D,SAAWyD,IAC1BlB,EAAMoB,OAAO3D,SAAWyD,EACxBlB,EAAMoB,OAAO5D,OAAS,GAGpBoC,EAAKV,IAASW,WACdwB,EAAQzB,EAAGG,IAAH,UAAiBW,GAnB1B,UAoBCW,EAAMlB,IAAIH,GApBX,QAqBL3C,IArBK,6C,+BAwBQiE,E,qFAAf,WAA8BC,EAAU9E,GAAxC,4FACQmD,EAAKV,IAASW,WACdG,EAAQJ,EAAGG,IAAH,UAAiBtD,GACzB+E,EAAcC,EAAiBF,GAC/BG,EAAYC,EAAgBH,GAClCxB,EAAMG,IAAIuB,GALZ,4C,sBAQO,SAAehF,EAAtB,kC,iDAAO,WAA2BD,GAA3B,iGACCmD,EAAKV,IAASW,WACd+B,EAAWhC,EAAGG,IAAH,UAAiBtD,GAF7B,SAGsBmF,EAASjB,KAAK,SAHpC,cAGCC,EAHD,yBAIEA,EAAaC,OAJf,4C,uEAOA,WAA0B5D,GAA1B,mGACCR,EAAOJ,IADR,SAEkBK,EAAYD,GAF9B,UAECmF,EAFD,OAGCC,EAAWD,EAASA,EAASE,OAAS,KACxCF,EAASE,OAAS,IAAM7E,EAAQ4E,EAAS5E,OAJxC,iCAKgBwD,IALhB,cAKGzD,EALH,OAMC4E,EAASE,OAAS,GACpBF,EAASA,EAASE,QAAU,CAAE9E,OAAMC,SAEpC2E,EAASA,EAASE,OAAS,GAAK,CAAE9E,OAAMC,SATvC,UAWGqE,EAAeM,EAAUnF,GAX5B,eAYHD,IAZG,mBAaI,GAbJ,kCAeE,GAfF,6C,sBAkBP,SAASmF,EAAgBI,GAGvB,IAFA,IAEA,EAFML,EAAY,GACZ7E,EAAM,IAAImF,IAChB,IAAmBD,KAAnB,aAAyB,KAAdE,EAAc,QAClBpF,EAAIqF,IAAID,EAAKjF,QAChBH,EAAIsD,IAAI8B,EAAKjF,MAAM,GACnB0E,EAAUzB,KAAK,CACbjD,KAAMiF,EAAKjF,KACXC,MAAOgF,EAAKhF,SAIlB,OAAOyE,EAGT,SAASD,EAAiBM,GACxB,MAAO,UAAIA,GAAMI,MAAK,SAACC,EAASC,GAAV,OAAuBA,EAASpF,MAAQmF,EAAQnF,SArNxEzC,EAAKM,MAAM0D,iBAAiB,S,8CAC5BhE,EAAKQ,OAAOwD,iBAAiB,SAgD7B,SAAgB1B,GACdA,EAAEkC,iBACFE,IAASD,OAAOqD,UAChB9H,EAAKmB,QAAQkD,MAAMC,QAAU,OAE7BR,EAAY9D,EAAKoB,cACjBpB,EAAKkB,SAASyB,UAAY,0BArD5B3C,EAAKO,OAAOyD,iBAAiB,S,8CAE7BU,IAASqD,cAAc,CACrBC,OAAQ,0CACRC,WAAY,8BACZC,YAAa,qCACbC,UAAW,cACXC,cAAe,0BACfC,kBAAmB,gBACnBC,MAAO,+CAIT5D,IAASD,OAAO8D,oBAAmB,SAAAC,GAC7BA,GACFxI,EAAKkB,SAASyB,UAAY,wBAC1BsD,IAAcwC,MAAK,SAAAxD,GAAI,OAAKjF,EAAKmB,QAAQuH,YAAczD,KACvDtB,EAAY3D,EAAKoB,cACjB0C,EAAY9D,EAAKqB,YACjBwB,IACA7C,EAAKc,aAAauD,MAAMC,QAAU,UAElCX,EAAY3D,EAAKqB,YACjBrB,EAAKmB,QAAQkD,MAAMC,QAAU,OAC7BtE,EAAKc,aAAauD,MAAMC,QAAU,WChCtCtC,I,kCCQe2G,EARA,SAAUC,EAAGC,EAAGC,EAAQC,GACrCC,GAAIC,YACJD,GAAIE,IAAIN,EAAGC,EAAGC,EAAQ,EAAa,EAAVK,KAAKC,IAAQ,GAClCL,GACFC,GAAIK,QCPA3I,EAAWV,EAAXU,OAEF4I,EAAU,WACd,IAAMC,EAAOrJ,SAASsJ,KAAKC,YAC3B,OAAIF,EAAO,MAAQA,EAAO,IACjB,IACEA,EAAO,KAAOA,EAAO,IACvB,IACEA,EAAO,IACT,IAEA,KAIX7I,EAAOgJ,MAAQJ,IACf5I,EAAOiJ,OAASL,IACT,IAAMI,EAAQhJ,EAAOgJ,MACfC,EAASjJ,EAAOiJ,OAIhBC,EAAgBF,EADJ,GAEZG,EAAiBF,EAFL,GCMVG,E,WAxBb,WAAYC,EAAKC,GACfC,KAAKF,IAAMA,EACXE,KAAKD,IAAMA,E,2BAGbE,WAAA,SAAWC,GACT,IAAMvB,EDYe,GCZXqB,KAAKF,IACTlB,EDWe,GCXXoB,KAAKD,IACfhB,GAAIoB,UAAYD,EAChBnB,GAAIqB,SAASzB,EAAGC,EDSK,Q,ECNvByB,WAAA,SAAWH,GACT,IAAMI,EDKe,GCLLN,KAAKF,IAAkBS,EACjCC,EDIe,GCJLR,KAAKD,IAAkBQ,EACvCxB,GAAIoB,UAAYD,EAChBxB,EAAO4B,EAASE,EAASD,GAAe,I,EAG1CE,MAAA,SAAMC,GACJ,OAAOV,KAAKF,MAAQY,EAAWZ,KAAOE,KAAKD,MAAQW,EAAWX,K,KCFnDY,EADD,I,WAjBZ,aACEX,KAAKY,SAAW,IAAIf,EAAM,GAAI,I,2BAGhCgB,KAAA,WACEb,KAAKY,SAASP,WAAW,W,EAG3BS,KAAA,WACE,IAAMC,EAAY7B,KAAK8B,MAAM9B,KAAK+B,UAAYtB,EAAgB,IAAM,EAC9DuB,EAAYhC,KAAK8B,MAAM9B,KAAK+B,UAAYrB,EAAiB,IAAM,EACrEI,KAAKY,SAAW,IAAIf,EAAMkB,EAAWG,I,gLC+J1BC,E,WAvKb,WAAYnJ,QAAqB,IAArBA,MVPc,WUQxBgI,KAAKoB,SAAW,CAAC,IAAIvB,EAAM,EAAG,GAAI,IAAIA,EAAM,EAAG,GAAI,IAAIA,EAAM,EAAG,IAChEG,KAAKqB,UAAY,QACjBrB,KAAKsB,cAAgB,QACrBtB,KAAKhI,KAAOA,EACZgI,KAAKxH,MAAQ,EACbwH,KAAKuB,cAAgB,I,iCAmBvBV,KAAA,WAEE,IADA,IAAIW,GAAgB,EACXlJ,EAAI,EAAGA,EAAI0H,KAAKoB,SAAS/D,OAAQ/E,GAAK,EACzCkJ,EACFxB,KAAKoB,SAAS9I,GAAG2H,WAAW,YAE5BD,KAAKoB,SAAS9I,GAAG2H,WAAW,YAE9BuB,GAAiBA,EAEnBxB,KAAKoB,SAAS,GAAGnB,WAAW,S,EAG9Ba,KAAA,WACE,IACIW,EADEC,EAAO1B,KAAKoB,SAAS,GAG3BpB,KAAKqB,UAAYrB,KAAKsB,cAEC,UAAnBtB,KAAKqB,UACPI,EAAU,IAAI5B,EAAM6B,EAAK5B,IAAM,EAAG4B,EAAK3B,KACX,SAAnBC,KAAKqB,UACdI,EAAU,IAAI5B,EAAM6B,EAAK5B,IAAK4B,EAAK3B,IAAM,GACb,SAAnBC,KAAKqB,UACdI,EAAU,IAAI5B,EAAM6B,EAAK5B,IAAM,EAAG4B,EAAK3B,KACX,OAAnBC,KAAKqB,YACdI,EAAU,IAAI5B,EAAM6B,EAAK5B,IAAK4B,EAAK3B,IAAM,IAGvCC,KAAK2B,eAAeF,GAEtBG,MAIF5B,KAAKoB,SAASS,QAAQJ,GAElBA,EAAQhB,MAAME,EAAMC,WACtBZ,KAAKxH,OAAS,EAEVwH,KAAKuB,eAAiB,EVxEJ,YUyEhBvB,KAAKhI,KACPgI,KAAKxH,MAAQ,GACRwH,KAAKuB,eAAiB,EACtBvB,KAAKuB,eAAiB,EV3EM,6BU4ExBvB,KAAKhI,OACVgI,KAAKxH,MAAQ,GACfwH,KAAKuB,eAAiB,EACbvB,KAAKxH,MAAQ,IAAMwH,KAAKxH,MAAQ,GACzCwH,KAAKuB,eAAiB,EACbvB,KAAKxH,MAAQ,IAAMwH,KAAKxH,MAAQ,GACzCwH,KAAKuB,eAAiB,EACbvB,KAAKxH,MAAQ,GACtBwH,KAAKuB,eAAiB,GACbvB,KAAKxH,MAAQ,KACtBwH,KAAKuB,cAAgBvB,KAAKuB,gBAGE,IAAvBvB,KAAKuB,eAA8C,IAAvBvB,KAAKuB,gBAC1CvB,KAAKuB,cAAgB,GAGvBZ,EAAMG,QAENd,KAAKoB,SAASU,Q,EAIlBC,yBAAA,SACEC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAX,GAcA,OAVIU,GAAiBF,EACnBR,EAAK5B,IAAM,EACFsC,GAAiBJ,EAC1BN,EAAK5B,IAAMH,EAAgB,EAClByC,GAAiBH,EAC1BP,EAAK3B,IAAMH,EAAiB,EACnBwC,GAAiBD,IAC1BT,EAAK3B,IAAM,GAGNsC,G,EAGTC,YAAA,SAAYF,EAAeC,GACzB,OAAOD,GAAiBC,G,EAG1BV,eAAA,SAAeD,GACb,IAAMM,EAA6B,IAAbN,EAAK5B,IACrBmC,EAA4B,IAAbP,EAAK3B,IACpBmC,EAAiBR,EAAK5B,MAAQH,EAAgB,EAC9CwC,EAAkBT,EAAK3B,MAAQH,EAAiB,EAChDwC,EACJJ,GAAiBC,GAAgBC,GAAkBC,EAEjDE,GAAgB,EAOpB,GANArC,KAAKoB,SAASmB,SAAQ,SAAAC,GAChBd,EAAKjB,MAAM+B,KACbH,GAAgB,MAIF,OAAdrC,KAAKhI,MAAiBgI,KAAKhI,KAAM,CACnC,GVhJsB,YUgJlBgI,KAAKhI,KACP,OAAOgI,KAAKsC,YAAYF,EAAeC,GAClC,GVjJ8B,6BUiJ1BrC,KAAKhI,KACd,OAAOgI,KAAK+B,yBACVC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAX,K,EAMRe,aAAA,SAAaC,GACY,OAAnB1C,KAAKqB,WAAuC,SAAjBqB,GAED,UAAnB1C,KAAKqB,WAA0C,SAAjBqB,GAEX,SAAnB1C,KAAKqB,WAAyC,OAAjBqB,GAEV,SAAnB1C,KAAKqB,WAAyC,UAAjBqB,IAGxC1C,KAAKsB,cAAgBoB,I,uCAzJrB,OAAO1C,KAAKxH,Q,6BAGDA,GACX,OAAQwH,KAAKxH,MAAQA,I,uCAIrB,OAAOwH,KAAKuB,gB,qCAGOoB,GACnB3C,KAAKuB,cAAgBoB,O,gCClBVC,EAXI,CACjBC,UAAW,OACXC,QAAS,KACTC,WAAY,QACZC,UAAW,OACXC,KAAM,OACNC,KAAM,KACNC,KAAM,QACNC,KAAM,QCLJC,EAAa,KACbC,GAAgB,KAEPC,GAAa,SAAAlL,GACxBA,EAAEkC,iBACFlC,EAAEmL,kBAEFH,EAAa,CACX1E,EAAGtG,EAAEoL,eAAe,GAAGC,QACvB9E,EAAGvG,EAAEoL,eAAe,GAAGE,SAEzBL,GAAgB,CAAE3E,EAAG0E,EAAW1E,EAAGC,EAAGyE,EAAWzE,IAGtCgF,GAAY,SAAAvL,GACvBA,EAAEkC,iBACFlC,EAAEmL,kBAEFF,GAAgB,CACd3E,EAAGtG,EAAEoL,eAAe,GAAGC,QACvB9E,EAAGvG,EAAEoL,eAAe,GAAGE,UAIdE,GAAW,SAAAxL,GACtBA,EAAEkC,iBACFlC,EAAEmL,kBACFM,KAEAT,EAAa,KACbC,GAAgB,MAGZQ,GAAc,WAClB,IAAIC,EAAI,CACNpF,EAAG0E,EAAW1E,EAAI2E,GAAc3E,EAChCC,EAAGyE,EAAWzE,EAAI0E,GAAc1E,GAI9B8D,EAAe,GAEfxD,KAAK8E,IAAID,EAAEpF,GAAKO,KAAK8E,IAAID,EAAEnF,GAEzBM,KAAK8E,IAAID,EAAEpF,GA7CC,KAiDZ+D,EAFEqB,EAAEpF,EAAI,EAEO,OAGA,SAKfO,KAAK8E,IAAID,EAAEnF,GAzDC,KA4DZ8D,EAFEqB,EAAEnF,EAAI,EAEO,KAGA,QAKrBqF,GAAqBvB,GACrB/G,QAAQuI,IAAIxB,IC3DRyB,I,UAAapO,EAAKW,QAAQ0N,iBAAiB,UACpCrF,GAAMhJ,EAAKU,OAAO4N,WAAW,MAEtCC,IAAU,EACVC,GAAQ,KACR/L,GAAQ,EAGNgM,GAAmB,SAAAnM,GACvB,OAAQA,EAAEoM,MACR,IAAK,YACL,IAAK,UACL,IAAK,aACL,IAAK,YACL,IAAK,QACHpM,EAAEkC,mBAOFmK,GAAkB,SAAArM,GACtB,IAAMqK,EAAeE,EAAWvK,EAAEoM,WACbE,IAAjBjC,GACF6B,GAAM9B,aAAaC,IAmCjBkC,GAAM7F,GAAI8F,qBAAqB,EAAG,EAAG,IAAK,GAChDD,GAAIE,aAAa,EAAG,YACpBF,GAAIE,aAAa,GAAK,aACtBF,GAAIE,aAAa,EAAG,YAEpB,IAAMC,GAAa,WACjBhG,GAAIoB,UAAYyE,GAChB7F,GAAIqB,SAAS,EAAG,EAAGX,ENzDI,IM0DvBV,GAAIqB,SAAS,EAAGV,EN1DO,GM0DaD,EN1Db,IM2DvBV,GAAIqB,SAAS,EAAG,EN3DO,GM2DOV,GAC9BX,GAAIqB,SAASX,EN5DU,GM4DS,EN5DT,GM4DuBC,IAKnCuE,GAAuB,SAAAvB,GAE9B4B,KAEiB,OAAjB5B,GACiB,SAAjBA,GACiB,UAAjBA,GACiB,SAAjBA,QAEqBiC,IAAjBjC,GACF6B,GAAM9B,aAAaC,KAQdd,GAAW,WACtB0C,IAAU,ET4CL,SAAP,2BS1CEU,CAAgBxM,ITiFX,SAAP,kCShFMyM,CAAWzM,KAGbT,IAGFwM,GAAMW,SAAW,EAEZZ,KACHvO,EAAKS,YAAY2O,gBAAgB,WAAY,YAC7ClP,SAASqD,oBAAoB,UAAWoL,IACxCP,GAAW5B,SAAQ,SAAAlK,GACjBA,EAAE8M,gBAAgB,WAAY,eAEhC9L,OAAOC,oBAAoB,UAAWkL,IAAkB,GAExD/N,OAAO6C,oBAAoB,cAAc,SAAAjB,GAAC,OAAIkL,GAAWlL,MACzD5B,OAAO6C,oBAAoB,aAAa,SAAAjB,GAAC,OAAIuL,GAAUvL,MACvD5B,OAAO6C,oBAAoB,WAAYuK,IACvCpN,OAAO6C,oBAAoB,cAAeuK,KAjE5C9E,GAAIqG,KAAO,iBACXrG,GAAIoB,UAAY,OAChBpB,GAAIsG,UAAY,SAChBtG,GAAIuG,aAAe,SACnBvG,GAAIwG,SAAS,YAAa9F,EAAQ,EAAGC,EAAS,IAyEhD,GAJqC,OAAjC7H,aAAaC,QAAQ,SACvBD,aAAa2N,QAAQ,ObzIK,Wa4IS,OAAjC3N,aAAaC,QAAQ,QAAkB,CACzC,IAAME,GAAOH,aAAaC,QAAQ,QAClCqM,GAAW5B,SAAQ,SAAAlK,GACbL,KAASK,EAAE4B,QAAQjC,MACrBK,EAAEoN,aAAa,UAAW,cAOhC,IAAMC,GAAiB,WACrBnB,GAAQ,IAAIpD,EAAMtJ,aAAaC,QAAQ,SACvCwM,IAAU,GAINqB,GAAW,SAAXA,IACJ,IAAIpE,EACU,OAAVgD,KACFhD,EAAgBgD,GAAMqB,iBACtBpN,GAAQ+L,GAAMsB,SACd9G,GAAI+G,UAAU,EAAG,EAAGrG,EAAOC,GAC3B3J,EAAKY,WAAW8H,YAAhB,UAAwCjG,GACxC+L,GAAMzD,OACNyD,GAAM1D,OACNF,EAAME,OACNkE,MAGET,KACFyB,WAAWJ,EAAUpE,GACrBxL,EAAKS,YAAYiP,aAAa,WAAY,YAC1CtB,GAAW5B,SAAQ,SAAAlK,GACjBA,EAAEoN,aAAa,WAAY,eAE7BpM,OAAOU,iBAAiB,UAAWyK,IAAkB,GACrDvO,SAAS8D,iBAAiB,UAAW2K,IAIrCjO,OAAOsD,iBAAiB,cAAc,SAAA1B,GAAC,OAAIkL,GAAWlL,MACtD5B,OAAOsD,iBAAiB,aAAa,SAAA1B,GAAC,OAAIuL,GAAUvL,MACpD5B,OAAOsD,iBAAiB,WAAY8J,IACpCpN,OAAOsD,iBAAiB,cAAe8J,MAG3CkB,KAGAhP,EAAKS,YAAYuD,iBAAiB,SArJV,WAClB8B,KACF6J,KACAC,MAEA/K,MAAM,gCAiJV7E,EAAKW,QAAQqD,iBAAiB,SA7IX,SAAA1B,GACjB,IAAML,EAAOK,EAAE2B,OAAOC,QAAQjC,KAC1BA,IACFH,aAAa2N,QAAQ,OAAQxN,GAC7BD,IACe8D,KAEbjD,QCxDG,IAAIoN,SAAQ,SAACC,EAASC,GAC3BH,WAAWE,EAAS,QAIbzH,MAAK,WACd,IAAMe,EAAOtJ,SAASC,cAAc,aAC9BiQ,EAAYlQ,SAASuB,eAAe,aAE1C2O,EAAUhN,UAAUS,IAAI,UACxBuM,EAAUhN,UAAUC,OAAO,WAC3BmG,EAAKpG,UAAUC,OAAO,a","file":"main.2d3270be0438e68fc7de.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfkCh0KDjAcD/wjAAAAAW9yTlQBz6J3mgAAAKpJREFUGNNj+I8GGIgS+JarrRsx8RtCoJVPw0vGN/x2xfJ/EIFototvzK4/t3xw+ClEYCJD+efdl3/YzX8BVfHDi5HTuWrfYcEtEDP+ffuzNkSMnUN/Ds+Cf0CBYwoMfMHrPl4KZihdzLwfKODN4JcuySumJcna+k8uACiQweDanSPKwMAgtWYfhz9Q4I0nkCOW3J7GzcDAtANs6PWl238AzX/enrGHGM8BABaxt9LDbfuEAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTEwLTI5VDEwOjE0OjQ3KzAwOjAwdDttFQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0xMC0yOVQxMDoxNDo0NyswMDowMAVm1akAAAAASUVORK5CYII=\"","const Refs = {\r\n  email: document.querySelector('#inputEmail'),\r\n  userName: document.querySelector('#inputUserName'),\r\n  password: document.querySelector('#inputPassword'),\r\n  login: document.querySelector('#loginbtn'),\r\n  singup: document.querySelector('#singupbtn'),\r\n  logout: document.querySelector('#logoutbtn'),\r\n  startButton: document.querySelector('.snake-start'),\r\n  canvas: document.querySelector('#canvas'),\r\n  modeWrp: document.querySelector('.mode-wrp'),\r\n  snakeScore: document.querySelector('.snake-score'),\r\n  topList: document.querySelector('.players-list'),\r\n  userStatsRef: document.querySelector('.individual-stats'),\r\n  userStats: document.querySelector('.individual-stats-wrapper'),\r\n  game: document.querySelector('.snake-wrp'),\r\n\r\n  gameWrap: document.querySelector('.main-content-wrap'),\r\n  regTitle: document.querySelector('.registration__title'),\r\n  regUser: document.querySelector('.registration__user'),\r\n  registration: document.querySelector('.registration'),\r\n  logoutWrap: document.querySelector('.logout-wrap'),\r\n\r\n  //auth-modal\r\n  mainSignInBtn: document.querySelector('.btn[data-type=\"signin\"]'),\r\n  mainSignUpBtn: document.querySelector('.btn[data-type=\"signup\"]'),\r\n  authModal: document.getElementById('auth-modal'),\r\n  authModalOverlay: document.getElementById('auth-modal-overlay'),\r\n  openModal: document.querySelector('.sing-in-wrap'),\r\n  closeModalBtn: document.getElementById('close-auth-modal'),\r\n};\r\n\r\nexport default Refs;\r\n","export const MODE_CLASSIC = 'classic';\r\nexport const MODE_IGNORE_WALLS_COLLISION = 'ignoreWallsCollisionMode';\r\n\r\nexport function getGameMode() {\r\n  const local = localStorage.getItem('mode');\r\n  if (local === MODE_IGNORE_WALLS_COLLISION) {\r\n    return 'arcade';\r\n  }\r\n  return MODE_CLASSIC;\r\n}\r\n","import { getTopStats, getUserStats } from './firebase';\r\nimport refs from './refs';\r\nimport { getGameMode } from './snake/modes';\r\n\r\nexport async function setStatsHTML() {\r\n  const mode = getGameMode();\r\n  const data = await getTopStats(mode);\r\n\r\n  const statsHTML = data.map((e, i) => {\r\n    if (i === 0) {\r\n      return `<li class=\"player bg-place\"><span class=\"players-number pn-one\">${\r\n        i + 1\r\n      }</span>${e.name} - ${e.score} points</li>`;\r\n    } else if (i === 1) {\r\n      return `<li class=\"player bg-place\"><span class=\"players-number pn-two\">${\r\n        i + 1\r\n      }</span>${e.name} - ${e.score} points</li>`;\r\n    } else if (i === 2) {\r\n      return `<li class=\"player bg-place\"><span class=\"players-number pn-three\">${\r\n        i + 1\r\n      }</span>${e.name} - ${e.score} points</li>`;\r\n    } else {\r\n      return `<li class=\"player\"><span class=\"players-number\">${i + 1}</span>${\r\n        e.name\r\n      } - ${e.score} points </li>`;\r\n    }\r\n  });\r\n  refs.topList.innerHTML = statsHTML.join(' ');\r\n}\r\n\r\nexport async function setPersonalStatsHTML() {\r\n  const mode = getGameMode();\r\n  const userStats = await getUserStats();\r\n  refs.userStats.innerHTML = '';\r\n  const markup = `<p class=\"top-description\">Total games: <span class=\"individual-stats-result\">${userStats.total}</span></p>\r\n  <p class=\"top-description\">Mode games: <span class=\"individual-stats-result\">${userStats[mode].total}</span></p>\r\n  <p class=\"top-description\">Max score: <span class=\"individual-stats-result\">${userStats[mode].maxScore}</span></p>`;\r\n\r\n  refs.userStats.insertAdjacentHTML('beforeend', markup);\r\n}\r\n","import refs from './refs';\r\n\r\nfunction onOpenAuthModal() {\r\n  refs.authModal.classList.add('is-open');\r\n\r\n  window.addEventListener('keydown', onPressEsc);\r\n}\r\n\r\nexport function onCloseModal() {\r\n  refs.authModal.classList.remove('is-open');\r\n  window.removeEventListener('keydown', onPressEsc);\r\n}\r\n\r\nfunction onPressEsc(event) {\r\n  if (event.key === 'Escape') {\r\n    onCloseModal();\r\n  }\r\n}\r\n\r\nfunction onClickBackDrop(event) {\r\n  if (event.target === event.currentTarget) {\r\n    onCloseModal();\r\n  }\r\n}\r\n\r\nrefs.openModal.addEventListener('click', event => {\r\n  if (\r\n    event.target.dataset.type !== 'logout' &&\r\n    event.target.nodeName === 'BUTTON'\r\n  ) {\r\n    onOpenAuthModal();\r\n  }\r\n\r\n  if (event.target.dataset.type === 'signin') {\r\n    refs.userName.style.display = 'none';\r\n    refs.email.style.display = 'block';\r\n    refs.password.style.display = 'block';\r\n    refs.login.style.display = 'block';\r\n    refs.singup.style.display = 'none';\r\n  }\r\n\r\n  if (event.target.dataset.type === 'signup') {\r\n    refs.userName.style.display = 'block';\r\n    refs.email.style.display = 'block';\r\n    refs.password.style.display = 'block';\r\n    refs.login.style.display = 'none';\r\n    refs.singup.style.display = 'inline-block';\r\n  }\r\n});\r\n\r\nrefs.closeModalBtn.addEventListener('click', event => {\r\n  onCloseModal();\r\n});\r\n\r\nrefs.authModalOverlay.addEventListener('click', onClickBackDrop);\r\n","export function hideElement(elem) {\r\n  elem.classList.add('is-hidden');\r\n}\r\n\r\nexport function showElement(elem) {\r\n  if (elem.classList.contains('is-hidden')) {\r\n    elem.classList.remove('is-hidden');\r\n  }\r\n  return;\r\n}\r\n","import Refs from './refs';\r\nimport { setStatsHTML, setPersonalStatsHTML } from './stats';\r\nimport { getGameMode } from './snake/modes';\r\nimport { onCloseModal } from './auth-modal';\r\nimport { hideElement, showElement } from './show-hide';\r\n\r\nimport firebase from 'firebase/app';\r\nimport 'firebase/auth';\r\nimport 'firebase/database';\r\n\r\nRefs.login.addEventListener('click', authorization);\r\nRefs.logout.addEventListener('click', logOut);\r\nRefs.singup.addEventListener('click', singUp);\r\n\r\nfirebase.initializeApp({\r\n  apiKey: 'AIzaSyBMhO0NQUdNhSwM2MzfffK0CnXNvO-SQ5Q',\r\n  authDomain: 'snake-e2214.firebaseapp.com',\r\n  databaseURL: 'https://snake-e2214.firebaseio.com',\r\n  projectId: 'snake-e2214',\r\n  storageBucket: 'snake-e2214.appspot.com',\r\n  messagingSenderId: '1059522027824',\r\n  appId: '1:1059522027824:web:73740d4b7a4ff4094228f5',\r\n});\r\n\r\n// будет переписана после подключения модальной страницы авторизации\r\nfirebase.auth().onAuthStateChanged(fbUser => {\r\n  if (fbUser) {\r\n    Refs.regTitle.innerHTML = 'You are logged in as:';\r\n    getUserName().then(user => (Refs.regUser.textContent = user));\r\n    hideElement(Refs.registration);\r\n    showElement(Refs.logoutWrap);\r\n    setPersonalStatsHTML();\r\n    Refs.userStatsRef.style.display = 'block';\r\n  } else {\r\n    hideElement(Refs.logoutWrap);\r\n    Refs.regUser.style.display = 'none';\r\n    Refs.userStatsRef.style.display = 'none';\r\n  }\r\n});\r\n\r\nasync function authorization(e) {\r\n  e.preventDefault();\r\n  try {\r\n    const auth = firebase.auth();\r\n    await auth.signInWithEmailAndPassword(\r\n      Refs.email.value,\r\n      Refs.password.value,\r\n    );\r\n\r\n    onCloseModal();\r\n    hideElement(Refs.registration);\r\n    Refs.regUser.style.display = 'block';\r\n\r\n    await getUserStats();\r\n  } catch {\r\n    alert('Failed to login');\r\n  }\r\n}\r\n\r\nfunction logOut(e) {\r\n  e.preventDefault();\r\n  firebase.auth().signOut();\r\n  Refs.regUser.style.display = 'none';\r\n\r\n  showElement(Refs.registration);\r\n  Refs.regTitle.innerHTML = 'Login / Registration';\r\n}\r\n\r\nasync function singUp(e) {\r\n  e.preventDefault();\r\n  try {\r\n    const userName = Refs.userName.value;\r\n    if (!userName.trim()) {\r\n      alert('Wrong user name');\r\n      return;\r\n    }\r\n    const nameAvailable = await userNameAvailable(userName);\r\n    if (nameAvailable) {\r\n      const auth = firebase.auth();\r\n      const user = await auth.createUserWithEmailAndPassword(\r\n        Refs.email.value,\r\n        Refs.password.value,\r\n      );\r\n\r\n      await addUserToDB(user, userName);\r\n      hideElement(Refs.registration);\r\n      Refs.regUser.style.display = 'block';\r\n      onCloseModal();\r\n    } else {\r\n      alert('Username already exists');\r\n    }\r\n  } catch {\r\n    alert('User with this e-mail already exists');\r\n  }\r\n}\r\n\r\nasync function addUserToDB({ user }, userName) {\r\n  try {\r\n    const { uid, email } = user;\r\n    const db = firebase.database();\r\n    const users = db.ref('users');\r\n    const stats = db.ref('stats');\r\n    const userNames = db.ref('userNames');\r\n    userNames.push(userName);\r\n    users.child(uid).set({ email: email, userName: userName });\r\n    stats.child(`${uid}/classic`).set({ total: 0, maxScore: 0 });\r\n    stats.child(`${uid}/arcade`).set({ total: 0, maxScore: 0 });\r\n    stats.child(`${uid}/total`).set(0);\r\n  } catch {\r\n    console.error('user add failed');\r\n  }\r\n}\r\n\r\nexport function userLoggedIn() {\r\n  return firebase.auth().currentUser ? true : false;\r\n}\r\n\r\nfunction getCurrentUserID() {\r\n  return firebase.auth().currentUser.uid;\r\n}\r\n\r\nasync function getUserName() {\r\n  const userID = getCurrentUserID();\r\n  const db = firebase.database();\r\n  const user = db.ref(`/users/${userID}/userName`);\r\n  const dataSnapshot = await user.once('value');\r\n  return dataSnapshot.val();\r\n}\r\n\r\nasync function userNameAvailable(userName) {\r\n  try {\r\n    const db = firebase.database();\r\n    const users = db.ref('userNames');\r\n    const dataSnapshot = await users.once('value');\r\n    const data = dataSnapshot.val();\r\n    const usedNames = Object.values(data);\r\n    return !usedNames.includes(userName);\r\n  } catch {\r\n    console.error('Cannot read data from DB!');\r\n  }\r\n}\r\n\r\nexport async function getUserStats() {\r\n  const userID = getCurrentUserID();\r\n  const db = firebase.database();\r\n  const userStats = db.ref(`/stats/${userID}`);\r\n  const dataSnapshot = await userStats.once('value');\r\n  return dataSnapshot.val();\r\n}\r\n\r\nexport async function updateUserStats(newScore) {\r\n  const userID = getCurrentUserID();\r\n  const stats = await getUserStats();\r\n  const mode = getGameMode();\r\n  stats.total += 1;\r\n\r\n  if (mode === 'classic') {\r\n    if (stats.classic.maxScore < newScore) {\r\n      stats.classic.maxScore = newScore;\r\n      stats.classic.total += 1;\r\n    }\r\n  }\r\n  if (mode === 'arcade') {\r\n    if (stats.arcade.maxScore < newScore) {\r\n      stats.arcade.maxScore = newScore;\r\n      stats.arcade.total += 1;\r\n    }\r\n  }\r\n  const db = firebase.database();\r\n  const Stats = db.ref(`/stats/${userID}`);\r\n  await Stats.set(stats);\r\n  setPersonalStatsHTML();\r\n}\r\n\r\nasync function updateTopStats(newStats, mode) {\r\n  const db = firebase.database();\r\n  const stats = db.ref(`/TOP10/${mode}`);\r\n  const sortedStats = getSortedTopList(newStats);\r\n  const uniqStats = getUniStatsList(sortedStats);\r\n  stats.set(uniqStats);\r\n}\r\n\r\nexport async function getTopStats(mode) {\r\n  const db = firebase.database();\r\n  const topStats = db.ref(`/TOP10/${mode}`);\r\n  const dataSnapshot = await topStats.once('value');\r\n  return dataSnapshot.val();\r\n}\r\n\r\nexport async function userGetTop(score) {\r\n  const mode = getGameMode();\r\n  const topStats = await getTopStats(mode);\r\n  const minScore = topStats[topStats.length - 1];\r\n  if (topStats.length < 10 || score > minScore.score) {\r\n    const name = await getUserName();\r\n    if (topStats.length < 10) {\r\n      topStats[topStats.length] = { name, score };\r\n    } else {\r\n      topStats[topStats.length - 1] = { name, score };\r\n    }\r\n    await updateTopStats(topStats, mode);\r\n    setStatsHTML();\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction getUniStatsList(list) {\r\n  const uniqStats = [];\r\n  const map = new Map();\r\n  for (const item of list) {\r\n    if (!map.has(item.name)) {\r\n      map.set(item.name, true);\r\n      uniqStats.push({\r\n        name: item.name,\r\n        score: item.score,\r\n      });\r\n    }\r\n  }\r\n  return uniqStats;\r\n}\r\n\r\nfunction getSortedTopList(list) {\r\n  return [...list].sort((firstEl, secondEl) => secondEl.score - firstEl.score);\r\n}\r\n","import Refs from './refs';\r\nimport './firebase';\r\nimport { setStatsHTML } from './stats';\r\n\r\nsetStatsHTML();\r\n","import { ctx } from './snake';\r\n\r\n//========circle========\r\n\r\nconst circle = function (x, y, radius, fillCircle) {\r\n  ctx.beginPath();\r\n  ctx.arc(x, y, radius, 0, Math.PI * 2, false);\r\n  if (fillCircle) {\r\n    ctx.fill();\r\n  }\r\n};\r\n\r\nexport default circle;\r\n","import Refs from '../refs';\r\nconst { canvas } = Refs;\r\n\r\nconst getSize = () => {\r\n  const size = document.body.clientWidth;\r\n  if (size < 1251 && size > 576) {\r\n    return 480;\r\n  } else if (size < 576 && size > 362) {\r\n    return 360;\r\n  } else if (size < 362) {\r\n    return 324;\r\n  } else {\r\n    return 528;\r\n  }\r\n};\r\n\r\ncanvas.width = getSize();\r\ncanvas.height = getSize();\r\nexport const width = canvas.width;\r\nexport const height = canvas.height;\r\n\r\n//=======blocks======\r\nexport const blockSize = 12;\r\nexport const widthInBlocks = width / blockSize;\r\nexport const heightInBlocks = height / blockSize;\r\n","import circle from './circle';\r\nimport { blockSize } from './blockSizes';\r\nimport { ctx } from './snake';\r\nclass Block {\r\n  constructor(col, row) {\r\n    this.col = col;\r\n    this.row = row;\r\n  }\r\n\r\n  drawSquare(color) {\r\n    const x = this.col * blockSize;\r\n    const y = this.row * blockSize;\r\n    ctx.fillStyle = color;\r\n    ctx.fillRect(x, y, blockSize, blockSize);\r\n  }\r\n\r\n  drawCircle(color) {\r\n    const centerX = this.col * blockSize + blockSize / 2;\r\n    const centerY = this.row * blockSize + blockSize / 2;\r\n    ctx.fillStyle = color;\r\n    circle(centerX, centerY, blockSize / 2, true);\r\n  }\r\n\r\n  equal(otherBlock) {\r\n    return this.col === otherBlock.col && this.row === otherBlock.row;\r\n  }\r\n}\r\n\r\nexport default Block;\r\n","import Block from './Block';\r\nimport { widthInBlocks, heightInBlocks } from './blockSizes';\r\n\r\nclass Apple {\r\n  constructor() {\r\n    this.position = new Block(10, 10);\r\n  }\r\n\r\n  draw() {\r\n    this.position.drawCircle('yellow');\r\n  }\r\n\r\n  move() {\r\n    const randomCol = Math.floor(Math.random() * (widthInBlocks - 2)) + 1;\r\n    const randomRow = Math.floor(Math.random() * (heightInBlocks - 2)) + 1;\r\n    this.position = new Block(randomCol, randomRow);\r\n\r\n    //check to see if apple has been moved to a block currently occupied by the snake\r\n  }\r\n}\r\n\r\nconst apple = new Apple();\r\nexport default apple;\r\n","import Block from './Block';\r\nimport apple from './Apple';\r\nimport { gameOver } from './snake';\r\nimport { MODE_CLASSIC, MODE_IGNORE_WALLS_COLLISION } from './modes';\r\nimport { widthInBlocks, heightInBlocks } from './blockSizes';\r\n\r\nclass Snake {\r\n  constructor(mode = MODE_CLASSIC) {\r\n    this.segments = [new Block(7, 5), new Block(6, 5), new Block(5, 5)];\r\n    this.direction = 'right';\r\n    this.nextDirection = 'right';\r\n    this.mode = mode;\r\n    this.score = 0;\r\n    this.animationTime = 100;\r\n  }\r\n\r\n  get getScore() {\r\n    return this.score;\r\n  }\r\n\r\n  set setScore(score) {\r\n    return (this.score = score);\r\n  }\r\n\r\n  get getAnimationTime() {\r\n    return this.animationTime;\r\n  }\r\n\r\n  set setAnimationTime(time) {\r\n    this.animationTime = time;\r\n  }\r\n\r\n  draw() {\r\n    let isEvenSegment = false;\r\n    for (let i = 0; i < this.segments.length; i += 1) {\r\n      if (isEvenSegment) {\r\n        this.segments[i].drawSquare('#33d9de ');\r\n      } else {\r\n        this.segments[i].drawSquare('#6ab1d7 ');\r\n      }\r\n      isEvenSegment = !isEvenSegment;\r\n    }\r\n    this.segments[0].drawSquare('#fff');\r\n  }\r\n\r\n  move() {\r\n    const head = this.segments[0];\r\n    let newHead;\r\n\r\n    this.direction = this.nextDirection;\r\n\r\n    if (this.direction === 'right') {\r\n      newHead = new Block(head.col + 1, head.row);\r\n    } else if (this.direction === 'down') {\r\n      newHead = new Block(head.col, head.row + 1);\r\n    } else if (this.direction === 'left') {\r\n      newHead = new Block(head.col - 1, head.row);\r\n    } else if (this.direction === 'up') {\r\n      newHead = new Block(head.col, head.row - 1);\r\n    }\r\n\r\n    if (this.checkCollision(newHead)) {\r\n      //console.log('dtp');\r\n      gameOver();\r\n      return;\r\n    }\r\n\r\n    this.segments.unshift(newHead);\r\n\r\n    if (newHead.equal(apple.position)) {\r\n      this.score += 1;\r\n\r\n      if (this.animationTime >= 3) {\r\n        if (this.mode === MODE_CLASSIC) {\r\n          this.score > 20\r\n            ? (this.animationTime -= 1)\r\n            : (this.animationTime -= 2);\r\n        } else if (this.mode === MODE_IGNORE_WALLS_COLLISION) {\r\n          if (this.score < 10) {\r\n            this.animationTime -= 3;\r\n          } else if (this.score > 10 && this.score < 28) {\r\n            this.animationTime -= 2;\r\n          } else if (this.score > 28 && this.score < 40) {\r\n            this.animationTime -= 1;\r\n          } else if (this.score > 40) {\r\n            this.animationTime -= 0.5;\r\n          } else if (this.score > 50) {\r\n            this.animationTime = this.animationTime;\r\n          }\r\n        }\r\n      } else if (this.animationTime === 1 || this.animationTime === 0) {\r\n        this.animationTime = 1;\r\n      }\r\n\r\n      apple.move();\r\n    } else {\r\n      this.segments.pop();\r\n    }\r\n  }\r\n\r\n  ignoreWallsCollisionMode(\r\n    leftCollision,\r\n    topCollision,\r\n    rightCollision,\r\n    bottomCollision,\r\n    wallCollision,\r\n    selfCollision,\r\n    head,\r\n  ) {\r\n    //змейка умеет ходить сквозь стены\r\n    //=================================\r\n    if (wallCollision && rightCollision) {\r\n      head.col = 1;\r\n    } else if (wallCollision && leftCollision) {\r\n      head.col = widthInBlocks - 1;\r\n    } else if (wallCollision && topCollision) {\r\n      head.row = heightInBlocks - 1;\r\n    } else if (wallCollision && bottomCollision) {\r\n      head.row = 1;\r\n    }\r\n\r\n    return selfCollision;\r\n  }\r\n\r\n  classicMode(wallCollision, selfCollision) {\r\n    return wallCollision || selfCollision; // if snake has dtp wit wall or herself\r\n  }\r\n\r\n  checkCollision(head) {\r\n    const leftCollision = head.col === 0;\r\n    const topCollision = head.row === 0;\r\n    const rightCollision = head.col === widthInBlocks - 1;\r\n    const bottomCollision = head.row === heightInBlocks - 1;\r\n    const wallCollision =\r\n      leftCollision || topCollision || rightCollision || bottomCollision;\r\n\r\n    let selfCollision = false;\r\n    this.segments.forEach(element => {\r\n      if (head.equal(element)) {\r\n        selfCollision = true;\r\n      }\r\n    });\r\n\r\n    if (this.mode !== null && this.mode) {\r\n      if (this.mode === MODE_CLASSIC) {\r\n        return this.classicMode(wallCollision, selfCollision);\r\n      } else if (this.mode === MODE_IGNORE_WALLS_COLLISION) {\r\n        return this.ignoreWallsCollisionMode(\r\n          leftCollision,\r\n          topCollision,\r\n          rightCollision,\r\n          bottomCollision,\r\n          wallCollision,\r\n          selfCollision,\r\n          head,\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  setDirection(newDirection) {\r\n    if (this.direction === 'up' && newDirection === 'down') {\r\n      return;\r\n    } else if (this.direction === 'right' && newDirection === 'left') {\r\n      return;\r\n    } else if (this.direction === 'down' && newDirection === 'up') {\r\n      return;\r\n    } else if (this.direction === 'left' && newDirection === 'right') {\r\n      return;\r\n    }\r\n    this.nextDirection = newDirection;\r\n  }\r\n}\r\n\r\nexport default Snake;\r\n","const directions = {\r\n  ArrowLeft: 'left',\r\n  ArrowUp: 'up',\r\n  ArrowRight: 'right',\r\n  ArrowDown: 'down',\r\n  KeyA: 'left',\r\n  KeyW: 'up',\r\n  KeyD: 'right',\r\n  KeyS: 'down',\r\n};\r\n\r\nexport default directions;\r\n","import { swipeDirectionsMaker } from './snake';\r\n\r\nconst sensitivity = 20; // sensitivity - amount of pixels, after witch gesture will be listening with swipe\r\nlet touchStart = null; //first position of touch\r\nlet touchPosition = null; //current position of touch\r\n\r\nexport const TouchStart = e => {\r\n  e.preventDefault();\r\n  e.stopPropagation();\r\n  //get current position of touch\r\n  touchStart = {\r\n    x: e.changedTouches[0].clientX,\r\n    y: e.changedTouches[0].clientY,\r\n  };\r\n  touchPosition = { x: touchStart.x, y: touchStart.y };\r\n};\r\n\r\nexport const TouchMove = e => {\r\n  e.preventDefault();\r\n  e.stopPropagation();\r\n  //get new position\r\n  touchPosition = {\r\n    x: e.changedTouches[0].clientX,\r\n    y: e.changedTouches[0].clientY,\r\n  };\r\n};\r\n\r\nexport const TouchEnd = e => {\r\n  e.preventDefault();\r\n  e.stopPropagation();\r\n  CheckAction(); //check witch gesture it was\r\n  //clearing positions\r\n  touchStart = null;\r\n  touchPosition = null;\r\n};\r\n\r\nconst CheckAction = () => {\r\n  let d = {\r\n    x: touchStart.x - touchPosition.x,\r\n    y: touchStart.y - touchPosition.y,\r\n    //get distance from start to ends points of touching (two axis)\r\n  };\r\n\r\n  let newDirection = '';\r\n\r\n  if (Math.abs(d.x) > Math.abs(d.y)) {\r\n    //Проверяем, движение по какой оси было длиннее\r\n    if (Math.abs(d.x) > sensitivity) {\r\n      //Проверяем, было ли движение достаточно длинным\r\n      if (d.x > 0) {\r\n        //Если значение больше нуля, значит пользователь двигал пальцем справа налево\r\n        newDirection = 'left';\r\n      } //Иначе он двигал им слева направо\r\n      else {\r\n        newDirection = 'right';\r\n      }\r\n    }\r\n  } else {\r\n    //Аналогичные проверки для вертикальной оси\r\n    if (Math.abs(d.y) > sensitivity) {\r\n      if (d.y > 0) {\r\n        //swipe up\r\n        newDirection = 'up';\r\n      } else {\r\n        //swipe down\r\n        newDirection = 'down';\r\n      }\r\n    }\r\n  }\r\n\r\n  swipeDirectionsMaker(newDirection);\r\n  console.log(newDirection);\r\n};\r\n","import Snake from './SnakeClass';\r\nimport directions from './directions';\r\nimport apple from './Apple';\r\n// import barrier from './Barrier';\r\nimport { MODE_CLASSIC } from './modes';\r\nimport { TouchStart, TouchMove, TouchEnd } from './touchFunctions';\r\nimport { width, height, blockSize } from './blockSizes';\r\nimport Refs from '../refs';\r\nimport { setStatsHTML, setPersonalStatsHTML } from '../stats';\r\nimport { updateUserStats, userGetTop, userLoggedIn } from '../firebase';\r\nimport '../../css/snake.css';\r\n\r\nconst modeInputs = Refs.modeWrp.querySelectorAll('input');\r\nexport const ctx = Refs.canvas.getContext('2d');\r\n\r\nlet playing = false;\r\nlet snake = null;\r\nlet score = 0;\r\n\r\n//handlers\r\nconst arrowKeysHandler = e => {\r\n  switch (e.code) {\r\n    case 'ArrowLeft':\r\n    case 'ArrowUp':\r\n    case 'ArrowRight':\r\n    case 'ArrowDown':\r\n    case 'Space':\r\n      e.preventDefault();\r\n      break; // Space\r\n    default:\r\n      break; // do not block other keys\r\n  }\r\n};\r\n\r\nconst directionsMaker = e => {\r\n  const newDirection = directions[e.code];\r\n  if (newDirection !== undefined) {\r\n    snake.setDirection(newDirection);\r\n  }\r\n};\r\n\r\nconst startBtnHandler = () => {\r\n  if (userLoggedIn()) {\r\n    createNewSnake();\r\n    gameLoop();\r\n  } else {\r\n    alert('You need to sign in first');\r\n  }\r\n};\r\n\r\nconst setNewMode = e => {\r\n  const mode = e.target.dataset.mode;\r\n  if (mode) {\r\n    localStorage.setItem('mode', mode);\r\n    setStatsHTML();\r\n    const userIn = userLoggedIn();\r\n    if (userIn) {\r\n      setPersonalStatsHTML();\r\n    }\r\n  }\r\n};\r\n\r\nconst drawGameOver = () => {\r\n  ctx.font = '500 52px Arial';\r\n  ctx.fillStyle = '#fff';\r\n  ctx.textAlign = 'center';\r\n  ctx.textBaseline = 'middle';\r\n  ctx.fillText('Game Over', width / 2, height / 2);\r\n};\r\n\r\n// ========border========\r\n\r\nconst grd = ctx.createLinearGradient(0, 0, 170, 0);\r\ngrd.addColorStop(0, '#6ab1d7 ');\r\ngrd.addColorStop(0.5, '#38d9de  ');\r\ngrd.addColorStop(1, '#33d9de ');\r\n\r\nconst drawBorder = () => {\r\n  ctx.fillStyle = grd;\r\n  ctx.fillRect(0, 0, width, blockSize);\r\n  ctx.fillRect(0, height - blockSize, width, blockSize);\r\n  ctx.fillRect(0, 0, blockSize, height);\r\n  ctx.fillRect(width - blockSize, 0, blockSize, height);\r\n};\r\n\r\n//=======================================swipes\r\n\r\nexport const swipeDirectionsMaker = newDirection => {\r\n  //set new directions\r\n  if (playing) {\r\n    if (\r\n      newDirection === 'up' ||\r\n      newDirection === 'down' ||\r\n      newDirection === 'right' ||\r\n      newDirection === 'left'\r\n    ) {\r\n      if (newDirection !== undefined) {\r\n        snake.setDirection(newDirection);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n//=======================================swipes\r\n\r\nexport const gameOver = () => {\r\n  playing = false;\r\n\r\n  updateUserStats(score);\r\n  if (userGetTop(score)) {\r\n    // можно что-то показать\r\n  } else {\r\n    setStatsHTML();\r\n  }\r\n\r\n  snake.setScore = 0;\r\n\r\n  if (!playing) {\r\n    Refs.startButton.removeAttribute('disabled', 'disabled');\r\n    document.removeEventListener('keydown', directionsMaker);\r\n    modeInputs.forEach(e => {\r\n      e.removeAttribute('disabled', 'disabled');\r\n    });\r\n    window.removeEventListener('keydown', arrowKeysHandler, false);\r\n\r\n    canvas.removeEventListener('touchstart', e => TouchStart(e)); //first touch\r\n    canvas.removeEventListener('touchmove', e => TouchMove(e)); //moving touch\r\n    canvas.removeEventListener('touchend', TouchEnd); // user end touching\r\n    canvas.removeEventListener('touchcancel', TouchEnd); // user end touching\r\n  }\r\n\r\n  drawGameOver();\r\n};\r\n\r\n//game mode\r\n\r\nif (localStorage.getItem('mode') === null) {\r\n  localStorage.setItem('mode', MODE_CLASSIC);\r\n}\r\n\r\nif (localStorage.getItem('mode') !== null) {\r\n  const mode = localStorage.getItem('mode');\r\n  modeInputs.forEach(e => {\r\n    if (mode === e.dataset.mode) {\r\n      e.setAttribute('checked', 'checked');\r\n    }\r\n  });\r\n}\r\n\r\n//__________create snake and apple__________\r\n\r\nconst createNewSnake = () => {\r\n  snake = new Snake(localStorage.getItem('mode'));\r\n  playing = true;\r\n};\r\n\r\n//start actions\r\nconst gameLoop = function () {\r\n  let animationTime;\r\n  if (snake !== null) {\r\n    animationTime = snake.getAnimationTime;\r\n    score = snake.getScore;\r\n    ctx.clearRect(0, 0, width, height);\r\n    Refs.snakeScore.textContent = `Score: ${score}`;\r\n    snake.move();\r\n    snake.draw();\r\n    apple.draw();\r\n    drawBorder();\r\n  }\r\n\r\n  if (playing) {\r\n    setTimeout(gameLoop, animationTime);\r\n    Refs.startButton.setAttribute('disabled', 'disabled');\r\n    modeInputs.forEach(e => {\r\n      e.setAttribute('disabled', 'disabled');\r\n    });\r\n    window.addEventListener('keydown', arrowKeysHandler, false);\r\n    document.addEventListener('keydown', directionsMaker);\r\n\r\n    //listeners for touching(swiping) in canvas\r\n\r\n    canvas.addEventListener('touchstart', e => TouchStart(e)); //first touch\r\n    canvas.addEventListener('touchmove', e => TouchMove(e)); //moving touch\r\n    canvas.addEventListener('touchend', TouchEnd); // user end touching\r\n    canvas.addEventListener('touchcancel', TouchEnd); // user end touching\r\n  }\r\n};\r\ndrawBorder();\r\n\r\n//listeners\r\nRefs.startButton.addEventListener('click', startBtnHandler);\r\nRefs.modeWrp.addEventListener('click', setNewMode);\r\n","function loadData() {\r\n  return new Promise((resolve, reject) => {\r\n    setTimeout(resolve, 1000);\r\n  });\r\n}\r\n\r\nloadData().then(() => {\r\n  const body = document.querySelector('.homepage');\r\n  const preloader = document.getElementById('preloader');\r\n\r\n  preloader.classList.add('hidden');\r\n  preloader.classList.remove('visible');\r\n  body.classList.remove('hidden');\r\n});\r\n"],"sourceRoot":""}